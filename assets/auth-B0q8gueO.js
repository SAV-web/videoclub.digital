import{K as m,o as h,M as E}from"./index-BXZsSHD8.js";const l=()=>({loginView:document.getElementById("login-view"),registerView:document.getElementById("register-view"),loginForm:document.getElementById("login-form"),registerForm:document.getElementById("register-form"),showRegisterBtn:document.getElementById("show-register-view"),showLoginBtn:document.getElementById("show-login-view"),authMessage:document.getElementById("auth-message")});function o(t,e="error"){const{authMessage:s}=l();if(s){if(!t){s.style.display="none",s.textContent="";return}s.textContent=t,s.className=`auth-message auth-message--${e}`,s.style.display="block"}}function g(t){const e=t.message.toLowerCase();return e.includes("invalid login")||e.includes("invalid credentials")?"Email o contraseña incorrectos.":e.includes("user already registered")?"Este email ya está registrado.":e.includes("rate limit")?"Demasiados intentos. Espera un momento.":e.includes("not confirmed")?"Por favor, confirma tu email primero.":e.includes("weak password")?"La contraseña es muy débil.":`Error: ${t.message}`}async function f(t,e){t.preventDefault(),o(null);const s=t.currentTarget,i=s.querySelector('button[type="submit"]'),r=i.textContent,u=s.id==="login-form",c=s.querySelector(u?"#login-email":"#register-email"),d=s.querySelector(u?"#login-password":"#register-password"),n=c?.value.trim(),a=d?.value.trim();if(!n||!a){o("Por favor, completa todos los campos."),n?a||d?.focus():c?.focus();return}i.disabled=!0,i.textContent="Procesando...",i.style.opacity="0.7";try{await e(n,a,s)}catch(w){console.error(w),o("Ocurrió un error inesperado de conexión.")}finally{i&&(i.disabled=!1,i.textContent=r,i.style.opacity="1")}}const y={login:async(t,e,s)=>{const{error:i}=await m.auth.signInWithPassword({email:t,password:e});i?o(g(i)):(h("¡Hola de nuevo! Sesión iniciada.","success"),E(),s.reset())},register:async(t,e,s)=>{const{data:i,error:r}=await m.auth.signUp({email:t,password:e});r?o(g(r)):i.user&&i.user.identities?.length===0?o("Este usuario ya está registrado.","error"):i.user&&(o("¡Registro exitoso! Revisa tu email para confirmar.","success"),s.reset())}};function p(t){const e=l();o(null),t?(e.loginView.style.display="none",e.registerView.style.display="block",setTimeout(()=>e.registerForm.querySelector("input")?.focus(),50)):(e.registerView.style.display="none",e.loginView.style.display="block",setTimeout(()=>e.loginForm.querySelector("input")?.focus(),50))}function b(){const t=l();t.loginForm&&(t.loginForm.addEventListener("submit",e=>f(e,y.login)),t.registerForm.addEventListener("submit",e=>f(e,y.register)),t.showRegisterBtn.addEventListener("click",()=>p(!0)),t.showLoginBtn.addEventListener("click",()=>p(!1)))}export{b as initAuthForms};

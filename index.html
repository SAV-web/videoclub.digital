<!DOCTYPE html>
<html lang="es">
<head>
    <!-- ================================================================= -->
    <!-- 1. METADATOS Y CONFIGURACIÓN
    <!-- ================================================================= -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>videoclub.digital - Tu brújula cinéfila y seriéfila inteligente</title>
    <meta name="description" content="Explora, filtra y descubre miles de películas y series. Tu brújula cinéfila y seriéfila inteligente para seguir tus gustos y encontrar tu próxima obra maestra.">
    <meta name="theme-color" content="#37474F">

    <!-- ================================================================= -->
    <!-- 2. MANIFEST Y SEO
    <!-- ================================================================= -->
    <link rel="manifest" href="/manifest.webmanifest">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "url": "https://videoclub.digital/",
        "name": "videoclub.digital",
        "description": "Explora, filtra y descubre miles de películas y series. Tu brújula cinéfila y seriéfila inteligente para seguir tus gustos y encontrar tu próxima obra maestra.",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://videoclub.digital/?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>

    <!-- ================================================================= -->
    <!-- 3. OPEN GRAPH (PARA REDES SOCIALES)
    <!-- ================================================================= -->
    <meta property="og:title" content="videoclub.digital">
    <meta property="og:description" content="Tu brújula cinéfila y seriéfila inteligente.">
    <meta property="og:image" content="https://videoclub.digital/src/img/og-image.png">
    <meta property="og:url" content="https://videoclub.digital">
    <meta property="og:type" content="website">

    <!-- ================================================================= -->
    <!-- 4. OPTIMIZACIÓN DE CARGA (RESOURCE HINTS)
    <!-- ================================================================= -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://wibygecgfczcvaqewleq.supabase.co" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://esm.sh" crossorigin>

    <link rel="modulepreload" href="/src/js/main.js">
    <link rel="modulepreload" href="/src/js/ui.js">
    <link rel="modulepreload" href="/src/js/api.js">
    <link rel="modulepreload" href="/src/js/state.js">
    <link rel="modulepreload" href="https://esm.sh/@supabase/supabase-js@2">

    <!-- ================================================================= -->
    <!-- 5. CSS CRÍTICO (ESTILOS PARA LA PRIMERA PINTURA)
    <!-- ================================================================= -->
    <style>
      :root{--color-bg:#f5f5f5;--color-surface:#FFFFFF;--color-text-primary:#333333;--color-text-secondary:#666666;--color-accent:#37474F;--color-accent-exclude:#90A4AE;--color-border:#E0E0E0;--font-title:'Roboto Slab',serif;--font-body:'Roboto',sans-serif;--radius-md:6px;--radius-round:50%;--shadow:0 5px 15px rgba(0,0,0,0.08);--z-index-header:900;--z-index-sidebar:1000}
      body.dark-mode{--color-bg:#121212;--color-surface:#282828;--color-text-primary:#E0E0E0;--color-text-secondary:#AAAAAA;--color-accent:#90A4AE;--color-accent-exclude:#546E7A;--color-border:#333333;--shadow:0 5px 20px rgba(0,0,0,0.25)}
      *{box-sizing:border-box;margin:0;padding:0}
      body{background-color:var(--color-bg);color:var(--color-text-primary);font-family:var(--font-body)}
      .main-layout{display:flex}
      .sidebar{width:200px;height:100vh;background-color:var(--color-surface);border-right:2px solid var(--color-border);position:sticky;top:0;z-index:var(--z-index-sidebar)}
      .main-content-wrapper {flex-grow: 1; display: flex; flex-direction: column; min-width: 0;}
      .content{flex-grow:1;padding:1rem 3rem 0.5rem;max-width:1920px;margin:0 auto;width: 100%;}
      .main-header{display:flex;align-items:center;flex-wrap:wrap;gap:1rem 1.5rem;position:sticky;top:0;z-index:var(--z-index-header);background-color:var(--color-bg);padding:1.5rem 3rem 1rem;margin-bottom:0;}
      .grid-container{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(165px,1fr));justify-content:start;}
      .main-header-primary-controls,.search-and-theme-group{display:flex;align-items:center;gap:1rem}
      .sort-control{display:flex;align-items:center;gap:.5rem}
      #sort-select{background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--radius-md);padding:.5rem}
      .type-filter-toggle{padding:0 .8rem;height:40px;border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center}
      .header-pagination-group{display:flex}
      .search-form{position:relative;display:flex;align-items:center}
      .search-form input{border:1px solid var(--color-border);padding:.6rem 2.5rem .6rem 1rem;border-radius:var(--radius-md);width:115px}
      .search-icon{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);color:var(--color-text-secondary);pointer-events:none}
      .theme-toggle{width:40px;height:40px;border-radius:var(--radius-round);cursor:pointer;display:flex;justify-content:center;align-items:center;padding:0;position:relative}
      .theme-icon{position:absolute;width:20px;height:20px}
      .moon-icon{opacity:1}
      .sun-icon{opacity:0}
      body.dark-mode .moon-icon{opacity:0}
      body.dark-mode .sun-icon{opacity:1}
      .skeleton-card{height:380px;background-color:var(--color-surface);border-radius:8px;position:relative;overflow:hidden;box-shadow:var(--shadow)}
      .skeleton-card::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(0,0,0,.04),transparent);animation:skeleton-loading 1.5s infinite}
      body.dark-mode .skeleton-card::after{background:linear-gradient(90deg,transparent,rgba(255,255,255,.08),transparent)}
      @keyframes skeleton-loading{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
    </style>

    <!-- ================================================================= -->
    <!-- 6. HOJAS DE ESTILO EXTERNAS
    <!-- ================================================================= -->
    <link rel="stylesheet" href="src/css/main.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@700&family=Roboto:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@6.6.6/css/flag-icons.min.css">
    <link rel="stylesheet" href="src/vendor/nouislider/nouislider.min.css"/>
    
    <noscript>
      <link rel="stylesheet" href="src/css/main.css"/>
    </noscript>
</head>

<body>
    <!-- Contenedor principal del layout (Sidebar + Contenido) -->
    <div class="main-layout">
        
        <!-- Sidebar de Navegación y Filtros -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-inner-wrapper">
                <header class="logo-area">
                    <h2 class="logo-title">
                        <span class="logo-line-1">videoclub</span>
                        <span class="logo-line-2">.digital</span>
                    </h2>
                </header>

                <nav class="play-button-container" aria-label="Controles principales">
                    <button id="play-button" class="sidebar-control-button" title="Limpiar filtros" aria-label="Limpiar filtros y reiniciar búsqueda">
                        <svg class="sidebar-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                        </svg>
                    </button>
                    <button id="toggle-rotation-btn" class="sidebar-control-button" aria-label="Pausar rotación de tarjetas">
                        <svg class="sidebar-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="6" y="4" width="4" height="16"></rect>
                            <rect x="14" y="4" width="4" height="16"></rect>
                        </svg>
                    </button>
                    <button id="theme-toggle" class="sidebar-control-button theme-toggle" title="Cambiar tema" aria-label="Cambiar entre tema claro y oscuro">
                        <svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                        <svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
                    </button>
                    <button id="rewind-button" class="sidebar-control-button" title="Cerrar sidebar" aria-label="Contraer sidebar">
                        <svg class="sidebar-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="11 19 2 12 11 5 11 19"></polygon>
                            <polygon points="22 19 13 12 22 5 22 19"></polygon>
                        </svg>
                    </button>
                </nav>
                
                <div class="sidebar-static-filters">
                    <div id="active-filters-container"></div>
                    <div id="year-slider-container">
                        <div id="year-slider-wrapper">
                            <div id="year-slider"></div>
                        </div>
                        <div id="year-input-container">
                            <div class="year-input-wrapper">
                                <input type="number" id="year-start-input" class="year-input" aria-label="Año de inicio">
                                <div class="year-input-stepper">
                                    <button type="button" class="stepper-btn stepper-up" aria-label="Incrementar año de inicio">▲</button>
                                    <button type="button" class="stepper-btn stepper-down" aria-label="Decrementar año de inicio">▼</button>
                                </div>
                            </div>
                            <span class="year-range-separator">·</span>
                            <div class="year-input-wrapper">
                                <input type="number" id="year-end-input" class="year-input" aria-label="Año de fin">
                                <div class="year-input-stepper">
                                    <button type="button" class="stepper-btn stepper-up" aria-label="Incrementar año de fin">▲</button>
                                    <button type="button" class="stepper-btn stepper-down" aria-label="Decrementar año de fin">▼</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="total-results-container" class="total-results-container" hidden>
                        <span class="total-results-label">Total: </span>
                        <span id="total-results-count" class="total-results-count">0</span>
                    </div>
                </div>

                <nav class="sidebar-scrollable-filters" aria-label="Filtros de contenido">
                    <section class="collapsible-section">
                        <button type="button" class="section-header" aria-expanded="false" aria-controls="selection-content">
                            <span>Selección</span>
                            <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>
                        <div class="active-filters-list"></div>
                        <div id="selection-content" class="section-content">
                            <button type="button" class="filter-link" data-filter-type="selection" data-filter-value="C">Criterion</button>
                            <button type="button" class="filter-link" data-filter-type="selection" data-filter-value="M">1001 Movies</button>
                            <button type="button" class="filter-link" data-filter-type="selection" data-filter-value="A">Arrow</button>
                            <button type="button" class="filter-link" data-filter-type="selection" data-filter-value="K">Kino Lorber</button>
                            <button type="button" class="filter-link" data-filter-type="selection" data-filter-value="E">Eureka</button>
                            <button type="button" class="filter-link" data-filter-type="selection" data-filter-value="H">Series HBO</button>
                            <button type="button" class="filter-link" data-filter-type="selection" data-filter-value="N">Netflix</button>
                        </div>
                    </section>
                    <section class="collapsible-section">
                        <button type="button" class="section-header" aria-expanded="false" aria-controls="genres-content">
                            <span>Géneros</span>
                            <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>
                        <div class="active-filters-list"></div>
                        <div id="genres-content" class="section-content">
                            <div id="genres-list-container">
                                <button type="button" class="filter-link" data-filter-type="genre" data-filter-value="Drama">Drama</button>
                                <button type="button" class="filter-link" data-filter-type="genre" data-filter-value="Comedia">Comedia</button>
                                <button type="button" class="filter-link" data-filter-type="genre" data-filter-value="Thriller">Thriller</button>
                                <button type="button" class="filter-link" data-filter-type="genre" data-filter-value="Acción">Acción</button>
                                <button type="button" class="filter-link" data-filter-type="genre" data-filter-value="Animación">Animación</button>
                                <button type="button" class="filter-link" data-filter-type="genre" data-filter-value="Documental">Documental</button>
                            </div>
                            <form class="sidebar-filter-form" data-filter-type="genre"><input type="text" placeholder="Otro género..." class="sidebar-filter-input"></form>
                        </div>
                    </section>
                    <section class="collapsible-section" id="countries-section">
                        <button type="button" class="section-header" aria-expanded="false" aria-controls="countries-content">
                            <span>Países</span>
                            <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>
                        <div class="active-filters-list"></div>
                        <div id="countries-content" class="section-content">
                            <div id="countries-list-container">
                                <button type="button" class="filter-link" data-filter-type="country" data-filter-value="EEUU">EEUU</button>
                                <button type="button" class="filter-link" data-filter-type="country" data-filter-value="España">España</button>
                                <button type="button" class="filter-link" data-filter-type="country" data-filter-value="UK">UK</button>
                                <button type="button" class="filter-link" data-filter-type="country" data-filter-value="Francia">Francia</button>
                                <button type="button" class="filter-link" data-filter-type="country" data-filter-value="Japón">Japón</button>
                                <button type="button" class="filter-link" data-filter-type="country" data-filter-value="Italia">Italia</button>
                            </div>
                            <form class="sidebar-filter-form" data-filter-type="country"><input type="text" placeholder="Otro país..." class="sidebar-filter-input"></form>
                        </div>
                    </section>
                    <section class="collapsible-section">
                        <button type="button" class="section-header" aria-expanded="false" aria-controls="directors-content">
                            <span>Directores</span>
                            <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>
                        <div class="active-filters-list"></div>
                        <div id="directors-content" class="section-content">
                            <button type="button" class="filter-link" data-filter-type="director" data-filter-value="Woody Allen">Woody Allen</button>
                            <button type="button" class="filter-link" data-filter-type="director" data-filter-value="Alfred Hitchcock">Hitchcock</button>
                            <button type="button" class="filter-link" data-filter-type="director" data-filter-value="Steven Spielberg">Spielberg</button>
                            <button type="button" class="filter-link" data-filter-type="director" data-filter-value="Martin Scorsese">Scorsese</button>
                            <button type="button" class="filter-link" data-filter-type="director" data-filter-value="Pedro Almodóvar">Almodóvar</button>
                            <form class="sidebar-filter-form" data-filter-type="director"><input type="text" placeholder="Otro director..." class="sidebar-filter-input"></form>
                        </div>
                    </section>
                    <section class="collapsible-section">
                        <button type="button" class="section-header" aria-expanded="false" aria-controls="actors-content">
                            <span>Actores</span>
                            <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>
                        <div class="active-filters-list"></div>
                        <div id="actors-content" class="section-content">
                            <button type="button" class="filter-link" data-filter-type="actor" data-filter-value="Tom Cruise">Tom Cruise</button>
                            <button type="button" class="filter-link" data-filter-type="actor" data-filter-value="Robert De Niro">De Niro</button>
                            <button type="button" class="filter-link" data-filter-type="actor" data-filter-value="Brad Pitt">Brad Pitt</button>
                            <button type="button" class="filter-link" data-filter-type="actor" data-filter-value="Helen Mirren">Helen Mirren</button>
                            <button type="button" class="filter-link" data-filter-type="actor" data-filter-value="Javier Bardem">Javier Bardem</button>
                            <form class="sidebar-filter-form" data-filter-type="actor"><input type="text" placeholder="Otro actor..." class="sidebar-filter-input"></form>
                        </div>
                    </section>
                </nav>
                <div id="user-profile-container" class="profile-container">
                    
                    <!-- BOTÓN DE LOGIN (Icono de "carita") -->
                    <!-- Se muestra solo cuando el usuario NO está logueado. -->
                    <button id="login-button" class="sidebar-control-button profile-button" title="Acceder a tu cuenta" aria-label="Acceder a tu cuenta de usuario">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </button>

                    <!-- GRUPO DE SESIÓN DE USUARIO (Avatar + Logout) -->
                    <!-- Se muestra solo cuando el usuario SÍ está logueado. -->
                    <div id="user-session-group" class="user-session-group" hidden>
                        <!-- El círculo con la inicial, que se ocultará cuando el sidebar esté recogido -->
                        <span id="user-avatar-initials" class="user-avatar"></span>
                        
                        <!-- El icono de salida, siempre visible cuando se está logueado -->
                        <button id="logout-button" class="sidebar-control-button logout-button" title="Cerrar sesión" aria-label="Cerrar sesión">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                        </button>
                    </div>

                </div>
            </div>
        </aside>

        <!-- Contenido Principal (Header + Galería) -->
        <main class="main-content-wrapper">
            <header class="main-header">
                <div class="main-header-primary-controls">
                    <div class="sort-control">
                        <select id="sort-select" aria-label="Criterio de ordenación">
                            <option value="relevance,asc">⮃ Orden</option>
                            <option value="year,desc">Recientes</option>
                            <option value="year,asc">Antiguas</option>
                            <option value="fa_rating,desc">Nota FA</option>
                            <option value="imdb_rating,desc">Nota IMDb</option>
                            <option value="fa_votes,desc">Votos FA</option>
                            <option value="imdb_votes,desc">Votos IMDb</option>
                        </select>
                    </div>

                    <button id="type-filter-toggle" class="type-filter-toggle" type="button" title="Filtrar por Cine o TV">Todo</button>
                    
                    <div class="header-pagination-group">
                        <button id="header-prev-btn" class="btn btn--icon" title="Página anterior" aria-label="Ir a la página anterior">&lt;</button>
                        <button id="header-next-btn" class="btn btn--icon" title="Página siguiente" aria-label="Ir a la página siguiente">&gt;</button>
                    </div>
                </div>

                <div class="search-and-theme-group">
                    <form id="search-form" class="search-form" role="search">
                        <input id="search-input" type="search" placeholder="Título" maxlength="50" aria-label="Buscar películas o series por título" autocomplete="off">
                        <svg class="search-icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                    </form>
                </div>
            </header>

            <section class="content" aria-label="Galería de películas y series">
                <div id="sidebar-overlay" class="sidebar-overlay"></div>
                <div id="grid-container" class="grid-container" aria-live="polite"></div>
                <nav id="pagination-container" class="pagination-container" aria-label="Navegación de páginas"></nav>
            </section>
        </main>
    </div>
    
    <button id="back-to-top" class="back-to-top" title="Volver al inicio" aria-label="Volver al inicio de la página">↑</button>

    <div id="toast-container" class="toast-container" aria-live="assertive"></div>
    
    <!-- ================================================================= -->
    <!-- MODAL DE AUTENTICACIÓN
    <!-- ================================================================= -->
    <div id="auth-overlay" class="auth-overlay" hidden></div>
    <div id="auth-modal" class="auth-modal" role="dialog" aria-modal="true" aria-labelledby="auth-title" hidden>
        <div class="auth-box">
            <header class="auth-header">
                <h2 id="auth-title" class="auth-logo-modal">
                    <span>videoclub</span>.<span>digital</span>
                </h2>
                <button id="auth-close-btn" class="auth-close-btn" aria-label="Cerrar">&times;</button>
            </header>

            <section id="login-view" aria-labelledby="login-title">
                <h3 id="login-title">Iniciar Sesión</h3>
                <form id="login-form" action="#" method="post">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" name="email" required autocomplete="email">
                    </div>
                    <div class="form-group">
                        <label for="login-password">Contraseña</label>
                        <input type="password" id="login-password" name="password" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="auth-button">Acceder</button>
                </form>
                <div class="auth-toggle-text">
                    ¿No tienes cuenta? 
                    <button type="button" id="show-register-view">Regístrate</button>
                </div>
            </section>

            <section id="register-view" style="display: none;" aria-labelledby="register-title">
                <h3 id="register-title">Crear Cuenta</h3>
                <form id="register-form" action="#" method="post">
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" name="email" required autocomplete="email" aria-describedby="email-hint">
                        <small id="email-hint">Te enviaremos un email de confirmación.</small>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Contraseña</label>
                        <input type="password" id="register-password" name="password" required minlength="6" autocomplete="new-password" aria-describedby="password-hint">
                        <small id="password-hint">Mínimo 6 caracteres.</small>
                    </div>
                    <button type="submit" class="auth-button">Crear Cuenta</button>
                </form>
                <div class="auth-toggle-text">
                    ¿Ya tienes una cuenta? 
                    <button type="button" id="show-login-view">Inicia sesión</button>
                </div>
            </section>

            <div id="auth-message" class="auth-message" style="display: none;" role="alert" aria-live="assertive"></div>
        </div>
    </div>
    
    <!-- ================================================================= -->
    <!-- PLANTILLAS PARA GENERACIÓN DINÁMICA DE CONTENIDO
    <!-- ================================================================= -->
    <template id="movie-card-template">
        <div class="movie-card">
            <div class="flip-card-inner">
                <div class="flip-card-front">
                    <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="" class="lazy-image" width="500" height="750" decoding="async" loading="lazy">
                    <div class="movie-info movie-summary">
                        <div class="title-director-block">
                            <h3 data-template="title"></h3>
                            <div class="front-director-info" data-template="director"></div>
                        </div>
                        <div class="movie-meta">
                            <div class="year-country-line">
                                <div class="low-rating-circle" data-template="low-rating-circle"></div>
                                <div class="star-rating-container" data-template="average-rating-stars">
                                    <svg class="star-icon" viewBox="0 0 24 24"><path class="star-icon-path star-icon-path--empty" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path class="star-icon-path star-icon-path--filled" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                                    <svg class="star-icon" viewBox="0 0 24 24"><path class="star-icon-path star-icon-path--empty" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path class="star-icon-path star-icon-path--filled" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                                    <svg class="star-icon" viewBox="0 0 24 24"><path class="star-icon-path star-icon-path--empty" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path class="star-icon-path star-icon-path--filled" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                                    <svg class="star-icon" viewBox="0 0 24 24"><path class="star-icon-path star-icon-path--empty" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path class="star-icon-path star-icon-path--filled" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                                </div>
                                <span data-template="year"></span>
                                <span class="country-info" data-template="country-container">
                                    <span class="fi" data-template="country-flag"></span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flip-card-back">
                    <div class="back-meta-header">
                        <div class="episode-duration-group">
                            <span data-template="episodes"></span>
                            <span data-template="duration"></span>
                        </div>
                        <a href="#" target="_blank" rel="noopener noreferrer" class="rating-line" data-template="wikipedia-link" style="display: none;" title="Ver en Wikipedia">
                            <svg class="rating-icon" data-template="wikipedia-icon" viewBox="0 0 455 455" fill="#B3404A" xmlns="http://www.w3.org/2000/svg"><title>Wikipedia</title><path d="M0,0v455h455V0H0z M385,118.141c0,1.918-1.558,3.47-3.477,3.47h-9.736 c-3.546,0-6.744,2.15-8.081,5.439l-88.815,217.909L230.16,244.55L182.3,344.958L90.709,126.964 c-1.364-3.239-4.535-5.345-8.049-5.345h-9.181c-1.918,0-3.479-1.56-3.479-3.479v-8.099h79.147l-0.223,8.193 c-0.05,1.886-1.593,3.385-3.477,3.385h-13.249c-4.926,0-8.302,4.971-6.495,9.548l64.305,162.675l32.522-70.485l-41.099-96.434 c-1.373-3.215-4.526-5.312-8.031-5.312h-6.392c-1.918,0-3.479-1.552-3.479-3.47v-8.099h59.436v8.099c0,1.918-1.56,3.47-3.477,3.47 c-5.013,0-8.398,5.133-6.421,9.745l24.288,56.572l24.799-56.52c2.021-4.614-1.355-9.788-6.401-9.788h-9.284 c-1.927,0-3.479-1.56-3.479-3.479v-8.099h62.242v8.099c0,1.918-1.552,3.479-3.479,3.479h-10.358c-3.385,0-6.471,1.962-7.903,5.03 l-38.312,81.925l35.772,84.058l62.589-161.542c1.739-4.57-1.637-9.472-6.53-9.472H321.54c-1.918,0-3.479-1.56-3.479-3.479v-8.099 H385V118.141z"/></svg>
                        </a>
                    </div>
                    <div class="ratings-container">
                        <a href="#" target="_blank" rel="noopener noreferrer" class="rating-line" data-template="fa-link">
                            <span class="rating-left">
                                <svg class="rating-icon" data-template="fa-icon" viewBox="0 0 192 192" version="1.0" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet"><title>FilmAffinity</title><rect width="192" height="192" fill="#4682B4"/><g transform="translate(0,192) scale(.1,-.1)" fill="#FFFFFF" stroke="none"><path d="m952 1393 c-11 -21 -31 -73 -47 -115 l-28 -78 -208 0 c-248 0 -239 4 -239 -106 l0 -74 165 0 165 0 0 -115 0 -115 -165 0 -165 0 0 -150 0 -150 -145 0 -146 0 3 373 3 374 30 48 c38 61 90 103 157 126 47 16 89 18 346 19 l292 0 -18 -37z m451 3 c56 -32 75 -63 126 -201 28 -75 37 -111 29 -116 -6 -4 -61 -10 -122 -14 -61 -4 -113 -8 -116 -9 -3 0 -11 19 -18 44 -8 25 -16 52 -19 60 -3 9 -15 -13 -27 -50 l-21 -65 -130 -12 c-71 -7 -133 -12 -136 -10 -4 1 19 72 51 157 51 135 64 160 99 191 52 46 91 59 173 55 50 -2 78 -10 111 -30z m-268 -625 c22 -6 22 -6 -22 -143 l-44 -138 -149 0 c-83 0 -150 1 -150 3 0 6 102 281 107 290 5 9 219 -1 258 -12z m532 -38 c30 -5 33 -11 72 -114 23 -60 41 -114 41 -120 0 -6 -56 -8 -152 -7 l-152 3 -38 125 c-21 69 -38 127 -38 129 0 4 225 -8 267 -16z"/></g></svg>
                                <span data-template="fa-rating"></span>
                            </span>
                            <div class="rating-bar-container" data-template="fa-votes-bar-container">
                                <div class="rating-bar" data-template="fa-votes-bar"></div>
                            </div>
                        </a>
                        <a href="#" target="_blank" rel="noopener noreferrer" class="rating-line" data-template="imdb-link">
                            <span class="rating-left">
                                <svg class="rating-icon" data-template="imdb-icon" viewBox="0 0 24 24" role="img" xmlns="http://www.w3.org/2000/svg" fill="#F5C618"><rect width="100%" height="100%" fill="#000000"/><title>IMDb icon</title><path d="M14.31 9.588v.005c-.077-.048-.227-.07-.42-.07v4.815c.27 0 .44-.06.5-.165.062-.104.095-.405.095-.885v-2.866c0-.33-.004-.54-.033-.63-.022-.096-.067-.163-.14-.204zM22.416 0H1.62C.742.06.06.744 0 1.596V22.38c.06.874.712 1.542 1.555 1.617.015.003.03.003.045.003h20.845c.88-.088 1.55-.826 1.555-1.71V1.71C24 .82 23.305.07 22.416 0zM4.792 15.626H2.887V8.26h1.905v7.366zm6.54-.002H9.67v-4.97L9 15.623H7.812l-.698-4.86-.007 4.86H5.44V8.26h2.468c.083.523.16 1.048.23 1.574l.27 1.87.442-3.444h2.483v7.364zm4.977-2.18c0 .655-.044 1.094-.104 1.32-.062.22-.17.4-.326.52-.15.13-.34.218-.57.266-.223.045-.57.075-1.02.075l-.004-.002H11.98V8.26h1.426c.914 0 1.45.047 1.77.128.325.09.575.225.745.42.165.18.273.404.313.645.05.235.076.705.076 1.402v2.588zm4.944.475c0 .45-.045.764-.09.99-.06.224-.195.404-.405.568-.226.166-.48.24-.78.24-.22 0-.5-.06-.68-.136-.19-.094-.358-.237-.515-.427l-.116.47h-1.717V8.26l-.02-.003h1.8v2.4c.15-.175.315-.31.51-.4.196-.083.466-.127.69-.127.226-.003.45.036.66.115.17.07.32.185.436.33.09.125.15.27.18.42.03.138.044.43.044.87v2.054zM19.08 11.205c-.12 0-.194.04-.225.12-.03.08-.06.29-.06.624v1.946c0 .324.03.533.06.623.04.086.13.14.226.134.12 0 .272-.047.3-.14.03-.097.046-.32.046-.674l.03-.002v-1.89c0-.303-.015-.508-.06-.603-.044-.1-.195-.14-.315-.14z"/></svg>
                                <span data-template="imdb-rating"></span>
                            </span>
                            <div class="rating-bar-container" data-template="imdb-votes-bar-container">
                                <div class="rating-bar" data-template="imdb-votes-bar"></div>
                            </div>
                        </a>
                    </div>
                    <div class="details-list">
                        <div class="detail-item"><span class="detail-label">🎬</span><span class="detail-data" data-template="genre"></span></div>
                        <div class="detail-item"><span class="detail-label">✨</span><span class="detail-data" data-template="actors"></span></div>
                    </div>
                    <div class="scrollable-content">
                        <div class="plot-summary-final" title="Sinopsis"><span class="detail-label">🔹</span><span data-template="synopsis"></span></div>
                        <div class="critic-review" title="Crítica" data-template="critic-container"><span class="detail-label">🔸</span><span data-template="critic"></span></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="sidebar-skeleton-template">
        <div class="collapsible-section">
            <div class="skeleton skeleton-sidebar-header"></div>
            <div class="section-content">
                <div class="skeleton skeleton-sidebar-line"></div>
                <div class="skeleton skeleton-sidebar-line"></div>
                <div class="skeleton skeleton-sidebar-line"></div>
            </div>
        </div>
    </template>
    
    <script src="src/vendor/nouislider/nouislider.min.js" defer></script>
    <script type="module" src="src/js/auth.js"></script>
    <script type="module" src="src/js/main.js"></script>
    
    <div id="quick-view-overlay" class="quick-view-overlay" hidden></div>
    <div id="quick-view-modal" class="quick-view-modal" role="dialog" aria-modal="true" aria-labelledby="quick-view-title" hidden>
        <button id="quick-view-close-btn" class="quick-view-close-btn" aria-label="Cerrar vista rápida">&times;</button>
        <div id="quick-view-content" class="quick-view-content"></div>
    </div>

    <template id="quick-view-template">
        <div class="quick-view-front">
            <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="" class="lazy-image" width="500" height="750" decoding="async" loading="lazy">
            <div class="movie-info movie-summary">
                <div class="title-director-block">
                    <h3 data-template="title" id="quick-view-title"></h3>
                    <div class="front-director-info" data-template="director"></div>
                </div>
                <div class="movie-meta">
                    <div class="year-country-line">
                        <div class="low-rating-circle" data-template="low-rating-circle"></div>
                        <div class="star-rating-container" data-template="average-rating-stars">
                            <svg class="star-icon" viewBox="0 0 24 24"><path class="star-icon-path star-icon-path--empty" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path class="star-icon-path star-icon-path--filled" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                            <svg class="star-icon" viewBox="0 0 24 24"><path class="star-icon-path star-icon-path--empty" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path class="star-icon-path star-icon-path--filled" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                            <svg class="star-icon" viewBox="0 0 24 24"><path class="star-icon-path star-icon-path--empty" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path class="star-icon-path star-icon-path--filled" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                            <svg class="star-icon" viewBox="0 0 24 24"><path class="star-icon-path star-icon-path--empty" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path class="star-icon-path star-icon-path--filled" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                        </div>
                        <span data-template="year"></span>
                        <span class="country-info" data-template="country-container">
                            <span class="fi" data-template="country-flag"></span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
        <div class="quick-view-back">
            <div class="back-meta-header">
                <div class="episode-duration-group">
                    <span data-template="episodes"></span>
                    <span data-template="duration"></span>
                </div>
                <a href="#" target="_blank" rel="noopener noreferrer" class="rating-line" data-template="wikipedia-link" style="display: none;" title="Ver en Wikipedia">
                    <svg class="rating-icon" data-template="wikipedia-icon" viewBox="0 0 455 455" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><title>Wikipedia</title><path d="M0,0v455h455V0H0z M385,118.141c0,1.918-1.558,3.47-3.477,3.47h-9.736 c-3.546,0-6.744,2.15-8.081,5.439l-88.815,217.909L230.16,244.55L182.3,344.958L90.709,126.964 c-1.364-3.239-4.535-5.345-8.049-5.345h-9.181c-1.918,0-3.479-1.56-3.479-3.479v-8.099h79.147l-0.223,8.193 c-0.05,1.886-1.593,3.385-3.477,3.385h-13.249c-4.926,0-8.302,4.971-6.495,9.548l64.305,162.675l32.522-70.485l-41.099-96.434 c-1.373-3.215-4.526-5.312-8.031-5.312h-6.392c-1.918,0-3.479-1.552-3.479-3.47v-8.099h59.436v8.099c0,1.918-1.56,3.47-3.477,3.47 c-5.013,0-8.398,5.133-6.421,9.745l24.288,56.572l24.799-56.52c2.021-4.614-1.355-9.788-6.401-9.788h-9.284 c-1.927,0-3.479-1.56-3.479-3.479v-8.099h62.242v8.099c0,1.918-1.552,3.479-3.479,3.479h-10.358c-3.385,0-6.471,1.962-7.903,5.03 l-38.312,81.925l35.772,84.058l62.589-161.542c1.739-4.57-1.637-9.472-6.53-9.472H321.54c-1.918,0-3.479-1.56-3.479-3.479v-8.099 H385V118.141z"/></svg>
                </a>
            </div>
            <div class="ratings-container"></div>
            <div class="details-list">
                <div class="detail-item"><span class="detail-label">🎬</span><span class="detail-data" data-template="genre"></span></div>
                <div class="detail-item"><span class="detail-label">✨</span><span class="detail-data" data-template="actors"></span></div>
            </div>
            <div class="scrollable-content">
                <div class="plot-summary-final" title="Sinopsis"><span class="detail-label">🔹</span><span data-template="synopsis"></span></div>
                <div class="critic-review" title="Crítica" data-template="critic-container"><span class="detail-label">🔸</span><span data-template="critic"></span></div>
            </div>
        </div>
    </template>
</body>
</html>